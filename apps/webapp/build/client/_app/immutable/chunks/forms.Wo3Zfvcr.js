import{i as E,u as w,j as L,av as k,at as M}from"./runtime.-IAcHVGa.js";import{p as T,i as D,a as F}from"./entry.F0RumkfI.js";function N(t,n,o){E(()=>{var r=w(()=>n(t,o==null?void 0:o())||{});if(o&&(r!=null&&r.update)){var a=!1,c={};L(()=>{var i=o();k(i),a&&M(c,i)&&(c=i,r.update(i))}),a=!0}if(r!=null&&r.destroy)return()=>r.destroy()})}function H(t){const n=JSON.parse(t);return n.data&&(n.data=T(n.data)),n}function y(t){return HTMLElement.prototype.cloneNode.call(t)}function O(t,n=()=>{}){const o=async({action:a,result:c,reset:i=!0,invalidateAll:s=!0})=>{c.type==="success"&&(i&&HTMLFormElement.prototype.reset.call(t),s&&await D()),(location.origin+location.pathname===a.origin+a.pathname||c.type==="redirect"||c.type==="error")&&F(c)};async function r(a){var d,p,b,h;if(((d=a.submitter)!=null&&d.hasAttribute("formmethod")?a.submitter.formMethod:y(t).method)!=="post")return;a.preventDefault();const i=new URL((p=a.submitter)!=null&&p.hasAttribute("formaction")?a.submitter.formAction:y(t).action),s=new FormData(t),u=(b=a.submitter)==null?void 0:b.getAttribute("name");u&&s.append(u,((h=a.submitter)==null?void 0:h.getAttribute("value"))??"");const f=new AbortController;let m=!1;const A=await n({action:i,cancel:()=>m=!0,controller:f,formData:s,formElement:t,submitter:a.submitter})??o;if(m)return;let l;try{const e=await fetch(i,{method:"POST",headers:{accept:"application/json","x-sveltekit-action":"true"},cache:"no-store",body:s,signal:f.signal});l=H(await e.text()),l.type==="error"&&(l.status=e.status)}catch(e){if((e==null?void 0:e.name)==="AbortError")return;l={type:"error",error:e}}A({action:i,formData:s,formElement:t,update:e=>o({action:i,result:l,reset:e==null?void 0:e.reset,invalidateAll:e==null?void 0:e.invalidateAll}),result:l})}return HTMLFormElement.prototype.addEventListener.call(t,"submit",r),{destroy(){HTMLFormElement.prototype.removeEventListener.call(t,"submit",r)}}}export{N as a,O as e};
