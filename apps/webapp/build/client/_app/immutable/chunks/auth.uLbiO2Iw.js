import{w as n}from"./index.AeigFpnP.js";import{g as r}from"./entry.F0RumkfI.js";function l(){const{subscribe:s,set:a,update:o}=n({user:null,isAuthenticated:!1,isLoading:!0});return{subscribe:s,login:e=>{o(t=>({...t,user:e,isAuthenticated:!0,isLoading:!1})),localStorage.setItem("auth",JSON.stringify({user:e,isAuthenticated:!0}))},logout:async()=>{try{(await fetch("/api/auth/logout",{method:"POST",headers:{"Content-Type":"application/json"}})).ok?(o(t=>({...t,user:null,isAuthenticated:!1,isLoading:!1})),localStorage.removeItem("auth"),await r("/login")):console.error("Logout failed")}catch(e){console.error("Logout failed",e)}},init:async()=>{const e=localStorage.getItem("auth");if(e){const{user:t,isAuthenticated:i}=JSON.parse(e);a({user:t,isAuthenticated:i,isLoading:!1})}else a({user:null,isAuthenticated:!1,isLoading:!1})}}}const g=l();export{g as a};
