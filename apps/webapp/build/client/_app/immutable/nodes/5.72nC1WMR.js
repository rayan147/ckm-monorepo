import"../chunks/disclose-version.bJ1TNjgf.js";import{p as he,f as G,t as H,a as pe,s as O,g as h,b as m,d as U,c as f,r as v,e as fe}from"../chunks/runtime.-IAcHVGa.js";import{a as q,t as J,c as ve}from"../chunks/template.2JA4nrVh.js";import{s as M}from"../chunks/render.b8-zIhki.js";import{i as ee}from"../chunks/if.rhLWI7XC.js";import{a as te,e as re}from"../chunks/forms.Wo3Zfvcr.js";import{r as D,b as ce}from"../chunks/attributes.30sH_1mL.js";import{b as ne}from"../chunks/input.-wl6lriZ.js";import{p as N}from"../chunks/proxy.-EQ_3oAC.js";import{r as ge}from"../chunks/legacy-client.JRc2EHbh.js";import{g as ye}from"../chunks/entry.F0RumkfI.js";import{a as be}from"../chunks/auth.uLbiO2Iw.js";import"../chunks/RestaurantForm.5W2s5SDh.js";import{C as we}from"../chunks/chef.ReSWN0ob.js";const E=Symbol.for("@ts-pattern/matcher"),xe=Symbol.for("@ts-pattern/isVariadic"),X="@ts-pattern/anonymous-select-key",ie=t=>!!(t&&typeof t=="object"),Q=t=>t&&!!t[E],A=(t,e,n)=>{if(Q(t)){const r=t[E](),{matched:a,selections:i}=r.match(e);return a&&i&&Object.keys(i).forEach(s=>n(s,i[s])),a}if(ie(t)){if(!ie(e))return!1;if(Array.isArray(t)){if(!Array.isArray(e))return!1;let r=[],a=[],i=[];for(const s of t.keys()){const u=t[s];Q(u)&&u[xe]?i.push(u):i.length?a.push(u):r.push(u)}if(i.length){if(i.length>1)throw new Error("Pattern error: Using `...P.array(...)` several times in a single pattern is not allowed.");if(e.length<r.length+a.length)return!1;const s=e.slice(0,r.length),u=a.length===0?[]:e.slice(-a.length),W=e.slice(r.length,a.length===0?1/0:-a.length);return r.every((b,S)=>A(b,s[S],n))&&a.every((b,S)=>A(b,u[S],n))&&(i.length===0||A(i[0],W,n))}return t.length===e.length&&t.every((s,u)=>A(s,e[u],n))}return Reflect.ownKeys(t).every(r=>{const a=t[r];return(r in e||Q(i=a)&&i[E]().matcherType==="optional")&&A(a,e[r],n);var i})}return Object.is(e,t)},R=t=>{var e,n,r;return ie(t)?Q(t)?(e=(n=(r=t[E]()).getSelectionKeys)==null?void 0:n.call(r))!=null?e:[]:Array.isArray(t)?I(t,R):I(Object.values(t),R):[]},I=(t,e)=>t.reduce((n,r)=>n.concat(e(r)),[]);function g(t){return Object.assign(t,{optional:()=>_e(t),and:e=>l(t,e),or:e=>Pe(t,e),select:e=>e===void 0?le(t):le(e,t)})}function _e(t){return g({[E]:()=>({match:e=>{let n={};const r=(a,i)=>{n[a]=i};return e===void 0?(R(t).forEach(a=>r(a,void 0)),{matched:!0,selections:n}):{matched:A(t,e,r),selections:n}},getSelectionKeys:()=>R(t),matcherType:"optional"})})}function l(...t){return g({[E]:()=>({match:e=>{let n={};const r=(a,i)=>{n[a]=i};return{matched:t.every(a=>A(a,e,r)),selections:n}},getSelectionKeys:()=>I(t,R),matcherType:"and"})})}function Pe(...t){return g({[E]:()=>({match:e=>{let n={};const r=(a,i)=>{n[a]=i};return I(t,R).forEach(a=>r(a,void 0)),{matched:t.some(a=>A(a,e,r)),selections:n}},getSelectionKeys:()=>I(t,R),matcherType:"or"})})}function o(t){return{[E]:()=>({match:e=>({matched:!!t(e)})})}}function le(...t){const e=typeof t[0]=="string"?t[0]:void 0,n=t.length===2?t[1]:typeof t[0]=="string"?void 0:t[0];return g({[E]:()=>({match:r=>{let a={[e??X]:r};return{matched:n===void 0||A(n,r,(i,s)=>{a[i]=s}),selections:a}},getSelectionKeys:()=>[e??X].concat(n===void 0?[]:R(n))})})}function _(t){return typeof t=="number"}function C(t){return typeof t=="string"}function K(t){return typeof t=="bigint"}g(o(function(t){return!0}));const k=t=>Object.assign(g(t),{startsWith:e=>{return k(l(t,(n=e,o(r=>C(r)&&r.startsWith(n)))));var n},endsWith:e=>{return k(l(t,(n=e,o(r=>C(r)&&r.endsWith(n)))));var n},minLength:e=>k(l(t,(n=>o(r=>C(r)&&r.length>=n))(e))),length:e=>k(l(t,(n=>o(r=>C(r)&&r.length===n))(e))),maxLength:e=>k(l(t,(n=>o(r=>C(r)&&r.length<=n))(e))),includes:e=>{return k(l(t,(n=e,o(r=>C(r)&&r.includes(n)))));var n},regex:e=>{return k(l(t,(n=e,o(r=>C(r)&&!!r.match(n)))));var n}});k(o(C));const P=t=>Object.assign(g(t),{between:(e,n)=>P(l(t,((r,a)=>o(i=>_(i)&&r<=i&&a>=i))(e,n))),lt:e=>P(l(t,(n=>o(r=>_(r)&&r<n))(e))),gt:e=>P(l(t,(n=>o(r=>_(r)&&r>n))(e))),lte:e=>P(l(t,(n=>o(r=>_(r)&&r<=n))(e))),gte:e=>P(l(t,(n=>o(r=>_(r)&&r>=n))(e))),int:()=>P(l(t,o(e=>_(e)&&Number.isInteger(e)))),finite:()=>P(l(t,o(e=>_(e)&&Number.isFinite(e)))),positive:()=>P(l(t,o(e=>_(e)&&e>0))),negative:()=>P(l(t,o(e=>_(e)&&e<0)))});P(o(_));const B=t=>Object.assign(g(t),{between:(e,n)=>B(l(t,((r,a)=>o(i=>K(i)&&r<=i&&a>=i))(e,n))),lt:e=>B(l(t,(n=>o(r=>K(r)&&r<n))(e))),gt:e=>B(l(t,(n=>o(r=>K(r)&&r>n))(e))),lte:e=>B(l(t,(n=>o(r=>K(r)&&r<=n))(e))),gte:e=>B(l(t,(n=>o(r=>K(r)&&r>=n))(e))),positive:()=>B(l(t,o(e=>K(e)&&e>0))),negative:()=>B(l(t,o(e=>K(e)&&e<0)))});B(o(K));g(o(function(t){return typeof t=="boolean"}));g(o(function(t){return typeof t=="symbol"}));g(o(function(t){return t==null}));g(o(function(t){return t!=null}));class Ae extends Error{constructor(e){let n;try{n=JSON.stringify(e)}catch{n=e}super(`Pattern matching error: no pattern matches value ${n}`),this.input=void 0,this.input=e}}const oe={matched:!1,value:void 0};function ae(t){return new Y(t,oe)}class Y{constructor(e,n){this.input=void 0,this.state=void 0,this.input=e,this.state=n}with(...e){if(this.state.matched)return this;const n=e[e.length-1],r=[e[0]];let a;e.length===3&&typeof e[1]=="function"?a=e[1]:e.length>2&&r.push(...e.slice(1,e.length-1));let i=!1,s={};const u=(b,S)=>{i=!0,s[b]=S},W=!r.some(b=>A(b,this.input,u))||a&&!a(this.input)?oe:{matched:!0,value:n(i?X in s?s[X]:s:this.input,this.input)};return new Y(this.input,W)}when(e,n){if(this.state.matched)return this;const r=!!e(this.input);return new Y(this.input,r?{matched:!0,value:n(this.input,this.input)}:oe)}otherwise(e){return this.state.matched?this.state.value:e(this.input)}exhaustive(){if(this.state.matched)return this.state.value;throw new Ae(this.input)}run(){return this.exhaustive()}returnType(){return this}}var Se=J('<div class="p-3 mb-4 text-sm text-red-700 bg-red-100 rounded-lg" role="alert"> </div>'),je=J(`<form method="POST" action="?/login" class="space-y-4"><div><input type="email" name="email" placeholder="Email address" required class="w-full px-3 py-2 border rounded-md"></div> <div><input type="password" name="password" placeholder="Password" required class="w-full px-3 py-2 border rounded-md"></div> <div class="flex items-center justify-between text-sm"><label class="flex items-center"><input type="checkbox" name="remember-me" class="mr-2"> Remember me</label> <a href="/forgot-password" class="text-indigo-600 hover:underline">Forgot password?</a></div> <button type="submit" class="w-full py-2 text-white bg-indigo-600 rounded-md hover:bg-indigo-700"> </button></form> <p class="mt-4 text-sm text-center">Don't have an account? <a href="/register" class="text-indigo-600 hover:underline">Create one</a></p>`,1),Oe=J('<form method="POST" action="?/verify" class="space-y-4"><input type="text" name="code" placeholder="Enter verification code" class="w-full px-3 py-2 border rounded-md"> <input type="hidden" name="email"> <button type="submit" class="w-full py-2 text-white bg-indigo-600 rounded-md hover:bg-indigo-700"> </button></form> <form method="POST" action="?/resendCode" class="mt-4"><input type="hidden" name="email"> <button type="submit" class="w-full py-2 text-white bg-indigo-600 rounded-md hover:bg-indigo-700">Resend Code</button></form>',1),Ee=J('<h2 class="mb-6 text-2xl font-bold text-center text-gray-900"> </h2> <!> <!>',1);function Te(t,e){he(e,!0);let n=U(1),r=U(""),a=U(""),i=U(""),s=U(!1),u=U("");ge(()=>{var w;(w=e.form)!=null&&w.step&&m(n,N(e.form.step))});const W=w=>{const y=w.formElement,j=new URL(y.action).pathname;return m(s,!0),m(u,""),async({result:p,update:L})=>{m(s,!1),console.log("Result:",p),console.log({actionUrl:j}),p.data.actionType==="resendCode"?ae(p).with({type:"success"},()=>{m(u,"Verification code has been resent to your email.")}).with({type:"failure"},c=>{var d;m(u,N(((d=c.data)==null?void 0:d.message)||"An error occurred. Please try again."))}).otherwise(()=>{m(u,"An unexpected error occurred. Please try again.")}):p.data.actionType==="verify"?await ae(p).with({type:"success"},async c=>{var d,x,T;((d=c.data)==null?void 0:d.type)==="success"&&((x=c.data)!=null&&x.location)&&(T=c.data)!=null&&T.user&&(be.login(c.data.user),m(r,N(c.data.email)),await ye(c.data.location))}).with({type:"failure"},c=>{var d;m(u,N(((d=c.data)==null?void 0:d.message)||"An error occurred. Please try again."))}).otherwise(()=>{m(u,"An unexpected error occurred. Please try again.")}):ae(p).with({type:"success"},c=>{var d;(d=c.data)!=null&&d.step&&(m(n,N(c.data.step)),m(r,N(c.data.email)))}).with({type:"failure"},c=>{var d;m(u,N(((d=c.data)==null?void 0:d.message)||"An error occurred. Please try again."))}).otherwise(()=>{m(u,"An unexpected error occurred. Please try again.")}),await L()}};var b=Ee(),S=G(b),ue=f(S,!0);v(S);var se=O(S,2);ee(se,()=>h(u),w=>{var y=Se(),j=f(y,!0);v(y),H(()=>M(j,h(u))),q(w,y)});var de=O(se,2);ee(de,()=>h(n)===1,w=>{var y=je(),j=G(y),p=f(j),L=f(p);D(L),v(p);var c=O(p,2),d=f(c);D(d),v(c);var x=O(c,4),T=f(x,!0);v(x),v(j),te(j,(V,F)=>re(V,F),()=>W),fe(2),H(()=>{x.disabled=h(s),M(T,h(s)?"Processing...":"Sign in")}),ne(L,()=>h(r),V=>m(r,V)),ne(d,()=>h(a),V=>m(a,V)),q(w,y)},w=>{var y=ve(),j=G(y);ee(j,()=>h(n)===2,p=>{var L=Oe(),c=G(L),d=f(c);D(d);var x=O(d,2);D(x);var T=O(x,2),V=f(T,!0);v(T),v(c),te(c,(z,$)=>re(z,$),()=>W);var F=O(c,2),Z=f(F);D(Z);var me=O(Z,2);v(F),te(F,(z,$)=>re(z,$),()=>W),H(()=>{ce(x,h(r)),T.disabled=h(s),M(V,h(s)?"Processing...":"Verify Code"),ce(Z,h(r)),me.disabled=h(s)}),ne(d,()=>h(i),z=>m(i,z)),q(p,L)},null,!0),q(w,y)}),H(()=>M(ue,h(n)===1?"Sign in to your account":"Enter Verification Code")),q(t,b),pe()}var Ce=J('<div class="flex items-center justify-center min-h-screen bg-gray-100"><div class="w-full max-w-md p-6 bg-white rounded-lg shadow-md"><div class="flex justify-center mb-6"><!></div> <!></div></div>');function Je(t,e){var n=Ce(),r=f(n),a=f(r),i=f(a);we(i,{}),v(a);var s=O(a,2);Te(s,{get form(){return e.form}}),v(r),v(n),q(t,n)}export{Je as component};
